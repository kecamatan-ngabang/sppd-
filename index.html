<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generator SPPD Kecamatan Ngabang</title>
<link rel="icon" type="image/png" href="faviicon.png">


<style>
  
  @page { size: A4 portrait; margin: 2.5cm; }
  body { font-family: Arial, sans-serif; background: #f5f7fa; margin: 0; padding: 30px; }
  .container {
    max-width: 900px; margin: auto; background: #fff;
    border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1);
    padding: 25px 40px;
  }
  h2 { text-align: center; color: #0a3c85; font-size: 20px; margin-bottom: 20px; }
  label { font-weight: bold; display: block; margin-top: 10px; }
  input, textarea {
    width: 100%; padding: 6px 10px; border: 1px solid #bbb;
    border-radius: 5px; margin-top: 5px; font-size: 12pt;
  }
  button {
    margin-top: 12px; padding: 8px 18px; border: none;
    border-radius: 6px; background: #0a3c85; color: white; cursor: pointer;
  }
  button:hover { background: #052c6b; }
  #preview { background: white; border: 1px solid #ccc; padding: 50px; margin-top: 30px; }

  /* --- Style Kop Surat --- */
  .kop {
    text-align: center; position: relative;
    padding-bottom: 10px; margin-bottom: 10px;
    border: none;
  }
  .kop img {
    position: absolute;
    top: 10px;        /* jarak logo dari atas */
    left: 15px;
    width: 70px;      /* lebar logo */
    height: 90px;     /* tinggi logo */
  }
  .kop h2 { font-size: 14pt; margin: 0; font-weight: bold; margin-top: 30px; }
  .kop h1 { font-size: 16pt; margin: 0; font-weight: bold; }
  .kop p { font-size: 11pt; margin: 0; }
  .kop .ngabang { font-weight: bold; letter-spacing: 4px; font-size: 11pt; margin-bottom: 8px; }

  .kop-line {
    border-top: 1.5pt solid black;
    border-bottom: 3.5pt solid black;
    margin-top: 8px;
    width: 93%;
    margin-left: auto;
    margin-right: auto;
  }

  .judul { text-align: center; margin-top: 20px; }
  .judul h3 {
    font-size: 14pt; font-weight: bold;
    text-decoration: underline;
    text-underline-offset: 3px;
    margin-bottom: 5px;
  }
  .judul p { font-size: 11pt; margin: 0; }

  .isi-surat { margin-top: 25px; font-size: 12pt; line-height: 1.6; }
  .isi-surat table { border-collapse: collapse; width: 100%; }
  .isi-surat td {
  vertical-align: top;
  padding: 2px 4px;
  font-size: 12pt;
}

/* Jarak sejajar antar kolom isi data petugas */
.petugas-table {
  border-collapse: collapse;
  width: 100%;
  margin-left: 50px;
  table-layout: fixed; /* penting agar jarak stabil */
}

.petugas-table td {
  font-size: 12pt;
  vertical-align: top;
  padding: 2px 4px;
  white-space: nowrap;
}

/* kolom label seperti Nama, Pangkat/Gol */
.petugas-table td:nth-child(2) {
  width: 100px; /* label tetap */
}

/* kolom tanda titik dua */
.petugas-table td:nth-child(3) {
  width: 10px;
  text-align: left;
}

/* kolom isian hasil input: 1.5cm dari tanda titik dua */
.petugas-table td:nth-child(4) {
  padding-left: 43px; /* 1.5 cm â‰ˆ 43px */
  width: calc(100% - 160px);
}


  .tengah { text-align: center; margin: 30px 0 15px 0; }
  .tanda-tangan { text-align: right; margin-top: 50px; }

.tanda-tangan p:nth-child(3) {
  margin-bottom: 40px; /* jarak antar jabatan & nama camat */
}


  .underline { text-decoration: underline; text-underline-offset: 2px; }
</style>
</head>

<body>
<div class="container">
  <h2>Surat  Perintah Tugas<br>Kecamatan Ngabang</h2>

  <label>Nomor Surat:</label>
  <input type="text" id="nomor" placeholder="Contoh: 094">
  <label>Tahun:</label>
  <input type="text" id="tahun" placeholder="Contoh: 2025">
  <label>Dasar Surat:</label>
  <textarea id="dasar" rows="3">Peraturan Bupati Landak Nomor 1 Tahun 2020 tentang Perjalanan Dinas Dalam Negeri Atas beban Anggaran Pendapatan dan Belanja Daerah Kabupaten Landak</textarea>
  <label>Keperluan:</label>
  <input type="text" id="keperluan" placeholder="Contoh: Menghadiri kegiatan pelatihan aparatur desa di Landak">
  <label>Tanggal Penetapan:</label>
  <input type="date" id="tanggal">

  <h3>Daftar Petugas</h3>
  <div id="petugasContainer"></div>
  <button type="button" onclick="tambahPetugas()">Tambah Petugas</button>

  <br><br>
  <button onclick="generatePreview()">Tampilkan Surat</button>

  <div id="preview"></div>

  <div id="exportButtons" style="display:none; text-align:center; margin-top:20px;">
    <button onclick="exportPDF()">Unduh PDF</button>
  </div>
</div>

<!-- Library -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
let petugasCount = 0;

function tambahPetugas() {
  petugasCount++;
  const div = document.createElement("div");
  div.classList.add("petugas");
  div.style.borderBottom = "1px dashed #ccc";
  div.style.marginBottom = "10px";
  div.innerHTML = `
    <label>Petugas ${petugasCount}</label>
    <input type="text" placeholder="Nama Lengkap" class="nama">
    <input type="text" placeholder="Pangkat/Gol" class="pangkat">
    <input type="text" placeholder="NIP" class="nip">
    <input type="text" placeholder="Jabatan" class="jabatan">
  `;
  document.getElementById("petugasContainer").appendChild(div);
}

function generatePreview() {
  const nomor = document.getElementById("nomor").value || "-";
  const tahun = document.getElementById("tahun").value || "-";
  const dasar = document.getElementById("dasar").value || "-";
  const keperluan = document.getElementById("keperluan").value || "-";
  const tanggalInput = document.getElementById("tanggal").value;
  const tanggal = tanggalInput ? new Date(tanggalInput) : new Date();
  const tglFormat = tanggal.toLocaleDateString("id-ID", { day: "numeric", month: "long", year: "numeric" });

  let petugasHTML = "";
  const petugas = document.querySelectorAll(".petugas");
  petugas.forEach((div, i) => {
    const nama = div.querySelector(".nama").value || "-";
    const pangkat = div.querySelector(".pangkat").value || "-";
    const nip = div.querySelector(".nip").value || "-";
    const jabatan = div.querySelector(".jabatan").value || "-";

   petugasHTML += `
  <table class="petugas-table">
    <tr>
      <td width="20px">${i + 1}.</td>
      <td>Nama</td><td>:</td><td>${nama}</td>
    </tr>
    <tr>
      <td></td><td>Pangkat/Gol</td><td>:</td><td>${pangkat}</td>
    </tr>
    <tr>
      <td></td><td>NIP</td><td>:</td><td>${nip}</td>
    </tr>
    <tr>
      <td></td><td>Jabatan</td><td>:</td><td>${jabatan}</td>
    </tr>
  </table><br>`;


  });

  document.getElementById("preview").innerHTML = `
    <div class="kop">
      <img src="logo.png" alt="Logo Kabupaten Landak">
      <h2>PEMERINTAH KABUPATEN LANDAK</h2>
      <h1>KECAMATAN NGABANG</h1>
      <p><i>Alamat : Jl. Gusti A. Rani Jalur II, Ngabang, Landak, Kalimantan Barat </i></p>
      <p><i>Laman : www.kecamatanngabang.landakkab.go.id</i></p>
      <p><i>Kode Pos 79357</i></p>

      
      <div class="kop-line"></div>
    </div>

    <div class="judul">
      <h3 class="underline">SURAT PERINTAH TUGAS</h3>
      <p>Nomor : ${nomor} / ${tahun}</p>
    </div>

    <div class="isi-surat">
      <table>
        <tr>
          <td width="70px"><b>Dasar</b></td>
          <td width="10px">:</td>
          <td>${dasar}</td>
        </tr>
      </table>

      <div class="tengah">MENUGASKAN</div>

      <table>
        <tr>
          <td width="70px"><b>Kepada</b></td>
          <td width="10px">:</td>
          <td></td>
        </tr>
      </table>
      ${petugasHTML}
      <table>
        <tr>
          <td width="70px"><b>Keperluan</b></td>
          <td width="10px">:</td>
          <td>${keperluan}</td>
        </tr>
      </table>
    </div>

    <div class="tanda-tangan">
      <p>Ditetapkan di Ngabang</p>
      <p>Pada tanggal ${tglFormat}</p>
      <p><b>CAMAT NGABANG</b></p><br><br><br>
      <p><b class="underline">YULLY NOMENSEN, S.STP</b></p>
      <p>Pembina (IV/b)</p>
      <p>NIP. 19840724 200212 1 001</p>
    </div>`;
  document.getElementById("exportButtons").style.display = "block";
}


async function exportPDF() {
  const { jsPDF } = window.jspdf;
  const element = document.getElementById("preview");

  // ðŸ”§ Render elemen dengan kualitas cukup tinggi tapi hemat ukuran
  const canvas = await html2canvas(element, {
    scale: 1.5,          // dari 3 â†’ turun supaya ukuran kecil tapi tetap jelas
    useCORS: true,
    scrollY: 0,
    scrollX: 0,
    windowWidth: element.scrollWidth,
    windowHeight: element.scrollHeight
  });

  // ðŸ”§ Ubah kanvas ke gambar PNG
  const imgData = canvas.toDataURL("image/jpeg", 0.8); // 0.8 = kompresi 80%
  const pdf = new jsPDF("p", "mm", "a4");

  const pageWidth = 210;  // lebar A4 mm
  const pageHeight = 297; // tinggi A4 mm
  const imgWidth = pageWidth;
  const imgHeight = (canvas.height * imgWidth) / canvas.width;

  let heightLeft = imgHeight;
  let position = 0;

  // ðŸ”§ Tambahkan halaman pertama
  pdf.addImage(imgData, "JPEG", 0, position, imgWidth, imgHeight, "", "FAST");
  heightLeft -= pageHeight;

  // ðŸ”§ Bagi otomatis jika melebihi 1 halaman
  while (heightLeft > 0) {
    position = heightLeft - imgHeight;
    pdf.addPage();
    pdf.addImage(imgData, "JPEG", 0, position, imgWidth, imgHeight, "", "FAST");
    heightLeft -= pageHeight;
  }

  pdf.save("Surat_Perintah_Tugas_Ngabang.pdf");
}
</script>

</body>
</html>


